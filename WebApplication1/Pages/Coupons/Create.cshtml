@page
@model Revia.Pages.Coupons.CreateModel
@{
    ViewData["Title"] = "Creează Cupon";
}

<div asp-validation-summary="All" class="text-danger"></div>

<div class="container mt-4">
    <h2>Creează Cupon pentru @Model.LocationName</h2>
    <hr />
    <form method="post">
        <input type="hidden" asp-for="LocationId" />

        <div class="mb-3">
            <label asp-for="Input.Title" class="form-label">Titlu Ofertă *</label>
            <input asp-for="Input.Title" class="form-control" placeholder="Ex: 1+1 Gratis la Burgeri" />
            <span asp-validation-for="Input.Title" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Input.Description" class="form-label">Descriere</label>
            <textarea asp-for="Input.Description" class="form-control" rows="3"></textarea>
        </div>

        <div class="mb-3">
            <label asp-for="Input.ExpirationDate" class="form-label">Data Expirării (Opțional)</label>
            <input asp-for="Input.ExpirationDate" class="form-control" type="date" />
            <small class="text-muted">Dacă lași gol, va expira în 30 de zile.</small>
        </div>

        <div class="mb-3">
            <label asp-for="Input.RequiredLevel" class="form-label text-primary fw-bold">Nivel Minim Necesar (Exclusivitate)</label>
            <input asp-for="Input.RequiredLevel" type="number" class="form-control" min="1" value="1" />
            <small class="text-muted">Setează un nivel mai mare (ex: 5 sau 10) pentru a face oferta exclusivă.</small>
        </div>

        <div class="card p-3 bg-light mb-3">
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="thresholdCheck" asp-for="Input.HasThreshold" onchange="toggleThreshold()">
                <label class="form-check-label" for="thresholdCheck">Necesită un număr minim de recenzii?</label>
            </div>
            <div id="thresholdInput" style="display:none;" class="mt-2">
                <label>Număr total recenzii necesare (Opțional):</label>
                <input asp-for="Input.ThresholdCount" type="number" min="1" class="form-control w-25" placeholder="1" />
                <small class="text-muted">Dacă e gol, se va seta automat la 1.</small>
            </div>
        </div>

        <button type="submit" class="btn btn-success">Creează Cupon</button>
        <a asp-page="/Locations/Details" asp-route-id="@Model.LocationId" class="btn btn-secondary">Anulează</a>
    </form>
</div>

<script>
    function toggleThreshold() {
        var check = document.getElementById('thresholdCheck');
        var div = document.getElementById('thresholdInput');
        div.style.display = check.checked ? 'block' : 'none';
    }
</script>